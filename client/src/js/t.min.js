window.addEventListener("load",(async()=>{const t="/api/v1/";async function e(){const t=localStorage.getItem("userId"),e=new Headers({"Content-Type":"application/json"}),n=JSON.stringify({userId:t});(await fetch("/logout",{method:"DELETE",headers:e,body:n})).ok&&(location.href="/login")}async function n(e){const s=new Headers({"Content-Type":"application/json"}),a=await fetch(t+"/bookmark",{method:"POST",headers:s,body:JSON.stringify({id:e})});return a.ok?a:c(n,e)}async function s(e){const n=new Headers({"Content-Type":"application/json"}),a=await fetch(t+"/bookmark",{method:"DELETE",headers:n,body:JSON.stringify({id:e})});return a.ok?a:c(s,e)}function a(a){const c=document.querySelector(".logout__container"),r=document.querySelector(".avatar");function i(t,e="",n=""){const s=document.createElement(t);return e&&s.setAttribute("class",e),n&&(s.textContent=n),s}function l(t){const e=i("div","thumb__recommend"),n=i("div","thumb__wrapper"),s=i("img");return s.setAttribute("src",t.thumbnail.regular.small),n.append(s),e.append(n,function(t="t"){const e=i("div",t="t"===t?"overlay__play__t":"overlay__play__r"),n=i("div","center"),s=i("img"),a=i("p","fs-bold-l","Play");return s.setAttribute("src","./assets/icon-play.svg"),n.append(s,a),e.append(n),e}("r"),function(t,e="t"){const n=t.isBookmarked?"full":"empty",s=i("div",`${e="r"===e?"bookmark r":"bookmark"} ${t.isBookmarked?"":"empty"}`);s.setAttribute("id",t.id);const a=i("img");return a.setAttribute("src",`./assets/icon-bookmark-${n}.svg`),s.appendChild(a),s}(t,"r")),e}function d(t){const e=i("div","movie__details__r"),n=i("div","top"),s=i("p","fs-s blend year",t.year),a=i("span","dot"),o=i("span","dot"),c=i("div","category"),r=i("img");r.setAttribute("src",function(t){return"Movie"===t?"./assets/icon-category-movie.svg":"./assets/icon-category-tv.svg"}(t.category)),r.setAttribute("alt",t.title);const l=i("p","fs-s blend category",t.category),d=i("p","fs-s blend rating",t.rating),v=i("h3","fs-bold-l title",t.title);return c.append(r,l),n.append(s,a,c,o,d),e.append(n,v),e}r?.addEventListener("click",(()=>{c.classList.toggle("none")})),c?.addEventListener("click",e);for(const t of a){const e=document.querySelector(".cards__s"),n=i("div","card__r");n.setAttribute("id",t.id),n.append(l(t),d(t)),e.append(n)}document.querySelectorAll(".bookmark").forEach((t=>{const e=t.getAttribute("id"),a=t.querySelector("img");t.addEventListener("click",(async()=>{if(t.classList.contains("empty")){const s=await n(e);a.src="./assets/icon-bookmark-full.svg",s.ok&&t.classList.toggle("empty")}else{const n=await s(e);a.src="./assets/icon-bookmark-empty.svg",n.ok&&t.classList.toggle("empty")}}))}));const v=document.querySelector(".input__search");function h(t,e,n){const s=document.createElement("div");s.setAttribute("class","cards__r");const a=document.createElement("h1");a.setAttribute("class","fs-xxl s__heading"),a.textContent=`Found ${t.length} ${t.length>1?"results":"result"} for '${e}'`,t.forEach((t=>{const e=i("div","card__r");e.append(l(t),d(t)),s.append(e)}));const o=document.createElement("section");o.append(a,s),n.replaceWith(o)}document.querySelector(".search").addEventListener("submit",(async e=>{e.preventDefault();const n=document.querySelector(".search + section"),s=await o(v.value);if(s){h(await s.json(),v.value,n)}else{if((await fetch(t+"refresh-token",{method:"GET"})).ok){const t=await o(v.value);if(t.ok){h(await t.json(),v.value,n)}}}}))}async function o(e){const n=await fetch(t+"search"+`?q=${encodeURI(e)}&type=tv`,{method:"GET"});return!!n.ok&&n}async function c(e,n){try{return(await fetch(t+"refresh-token",{method:"GET"})).ok?e(n):window.location.href="/login"}catch(t){window.location.href="/login"}}!async function e(){try{const n=await fetch(t+"tv");return n.ok?(document.querySelector("body").innerHTML='<div class="container">\n      <aside class="sidebar">\n        <div role="banner" class="logo">\n          <a href="/"><img src="./assets/logo.svg" alt="logo"></a>\n        </div>\n        <nav role"navigation" class="navbar">\n          <a href="/">\n            <svg class="home" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 0H1C.4 0 0 .4 0 1v7c0 .6.4 1 1 1h7c.6 0 1-.4 1-1V1c0-.6-.4-1-1-1Zm0 11H1c-.6 0-1 .4-1 1v7c0 .6.4 1 1 1h7c.6 0 1-.4 1-1v-7c0-.6-.4-1-1-1ZM19 0h-7c-.6 0-1 .4-1 1v7c0 .6.4 1 1 1h7c.6 0 1-.4 1-1V1c0-.6-.4-1-1-1Zm0 11h-7c-.6 0-1 .4-1 1v7c0 .6.4 1 1 1h7c.6 0 1-.4 1-1v-7c0-.6-.4-1-1-1Z" fill="#5A698F"/></svg>\n          </a>\n          <a href="movies">\n            <svg class="movies" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M16.956 0H3.044A3.044 3.044 0 0 0 0 3.044v13.912A3.044 3.044 0 0 0 3.044 20h13.912A3.044 3.044 0 0 0 20 16.956V3.044A3.044 3.044 0 0 0 16.956 0ZM4 9H2V7h2v2Zm-2 2h2v2H2v-2Zm16-2h-2V7h2v2Zm-2 2h2v2h-2v-2Zm2-8.26V4h-2V2h1.26a.74.74 0 0 1 .74.74ZM2.74 2H4v2H2V2.74A.74.74 0 0 1 2.74 2ZM2 17.26V16h2v2H2.74a.74.74 0 0 1-.74-.74Zm16 0a.74.74 0 0 1-.74.74H16v-2h2v1.26Z" fill="#5A698F"/></svg>\n          </a>\n          <a href="/tv">\n            <svg class="tv__series active" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M20 4.481H9.08l2.7-3.278L10.22 0 7 3.909 3.78.029 2.22 1.203l2.7 3.278H0V20h20V4.481Zm-8 13.58H2V6.42h10v11.64Zm5-3.88h-2v-1.94h2v1.94Zm0-3.88h-2V8.36h2v1.94Z" fill="#5A698F"/></svg>\n          </a>\n          <a href="/bookmark">\n            <svg class="bookmark__nav" viewBox="0 0 17 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.387 0c.202 0 .396.04.581.119.291.115.522.295.694.542.172.247.258.52.258.82v17.038c0 .3-.086.573-.258.82a1.49 1.49 0 0 1-.694.542 1.49 1.49 0 0 1-.581.106c-.423 0-.79-.141-1.098-.423L8.46 13.959l-5.83 5.605c-.317.29-.682.436-1.097.436-.202 0-.396-.04-.581-.119a1.49 1.49 0 0 1-.694-.542A1.402 1.402 0 0 1 0 18.52V1.481c0-.3.086-.573.258-.82A1.49 1.49 0 0 1 .952.119C1.137.039 1.33 0 1.533 0h13.854Z" fill="#5A698F"/></svg>\n          </a>\n        </nav>\n        <div class="avatar">\n          <img src="./assets/image-avatar.png" alt="avatar">\n        </div>\n        <div class="logout__container none">\n          <div class="logout"><p>Logout</p></div>\n        </div>\n      </aside>\n      <main role="main">\n        <form class="search">\n          <img class="logo__search" src="./assets/icon-search.svg" alt="logo search">\n          <label class="input__label">\n            <input class="input__search fs-xl" type="text" name="s" id="search" placeholder="Search for movies or TV series" value="">\n          </label>\n        </form>\n        <section class="intl__sect">\n          <h3 class="fs-xxl">TV Series</h3>\n          <div class="cards__s"></div>\n        </section>\n      </main>\n    </div>',a(await n.json())):c(e)}catch(t){console.log()}}()}));