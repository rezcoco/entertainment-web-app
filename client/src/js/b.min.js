window.addEventListener("load",(async()=>{const e="/api/v1/";async function t(){const e=localStorage.getItem("userId"),t=new Headers({"Content-Type":"application/json"}),n=JSON.stringify({userId:e});(await fetch("/logout",{method:"DELETE",headers:t,body:n})).ok&&(location.href="/login")}async function n(t){const a=new Headers({"Content-Type":"application/json"}),o=await fetch(e+"/bookmark",{method:"POST",headers:a,body:JSON.stringify({id:t})});return o.ok?o:c(n,t)}async function a(t){const n=new Headers({"Content-Type":"application/json"}),o=await fetch(e+"/bookmark",{method:"DELETE",headers:n,body:JSON.stringify({id:t})});return o.ok?o:c(a,t)}function o(o,c){const r=document.querySelector("main"),i=document.querySelector(".logout__container"),l=document.querySelector(".avatar"),d=document.querySelector(".container__b");function v(e,t="",n=""){const a=document.createElement(e);return t&&a.setAttribute("class",t),n&&(a.textContent=n),a}function m(e){const t=v("div","thumb__recommend"),n=v("div","thumb__wrapper"),a=v("img");return a.setAttribute("src",e.thumbnail.regular.small),n.append(a),t.append(n,function(e="t"){const t=v("div",e="t"===e?"overlay__play__t":"overlay__play__r"),n=v("div","center"),a=v("img"),o=v("p","fs-bold-l","Play");return a.setAttribute("src","./assets/icon-play.svg"),n.append(a,o),t.append(n),t}("r"),function(e,t="t"){const n=e.isBookmarked?"full":"empty",a=v("div",`${t="r"===t?"bookmark r":"bookmark"} ${e.isBookmarked?"":"empty"}`);a.setAttribute("id",e.id);const o=v("img");return o.setAttribute("src",`./assets/icon-bookmark-${n}.svg`),a.appendChild(o),a}(e,"r")),t}function p(e){const t=v("div","movie__details__r"),n=v("div","top"),a=v("p","fs-s blend year",e.year),o=v("span","dot"),s=v("span","dot"),c=v("div","category"),r=v("img");r.setAttribute("src",function(e){return"Movie"===e?"./assets/icon-category-movie.svg":"./assets/icon-category-tv.svg"}(e.category)),r.setAttribute("alt",e.title);const i=v("p","fs-s blend category",e.category),l=v("p","fs-s blend rating",e.rating),d=v("h3","fs-bold-l title",e.title);return c.append(r,i),n.append(a,o,c,s,l),t.append(n,d),t}if(l?.addEventListener("click",(()=>{i.classList.toggle("none")})),i?.addEventListener("click",t),o.length>0){const e=v("section","intl__sect movies__b"),t=v("h3","fs-xxl","Bookmarked Movies"),n=v("div","cards__bm");e.append(t,n),r.append(e);for(const e of o){const t=v("div","card__r");t.append(m(e),p(e)),n.append(t)}d.append(e)}if(c.length>0){const e=v("section","intl__sect tv__b"),t=v("h3","fs-xxl","Bookmarked TV Series"),n=v("div","cards__bt");e.append(t,n),r.append(e);for(const e of c){const t=v("div","card__r");t.setAttribute("id",e.id),t.append(m(e),p(e)),n.append(t)}d.append(e)}document.querySelectorAll(".bookmark").forEach((e=>{const t=e.getAttribute("id"),o=e.querySelector("img");e.addEventListener("click",(async()=>{if(e.classList.contains("empty")){const a=await n(t);o.src="./assets/icon-bookmark-full.svg",a.ok&&e.classList.toggle("empty")}else{const n=await a(t);o.src="./assets/icon-bookmark-empty.svg",n.ok&&e.classList.toggle("empty")}}))}));const h=document.querySelector(".input__search");function u(e,t,n){const a=document.createElement("div");a.setAttribute("class","cards__r");const o=document.createElement("h1");o.setAttribute("class","fs-xxl s__heading"),o.textContent=`Found ${e.length} ${e.length>1?"results":"result"} for '${t}'`,e.forEach((e=>{const t=v("div","card__r");t.append(m(e),p(e)),a.append(t)}));const s=document.createElement("div");s.append(o,a),n.replaceWith(s)}document.querySelector(".search").addEventListener("submit",(async t=>{t.preventDefault();const n=document.querySelector(".search + div"),a=await s(h.value);if(a){u(await a.json(),h.value,n)}else{if((await fetch(e+"refresh-token",{method:"GET"})).ok){const e=await s(h.value);if(e.ok){u(await e.json(),h.value,n)}}}}))}async function s(t){const n=await fetch(e+"search"+`?q=${encodeURI(t)}&type=bookmark`,{method:"GET"});return!!n.ok&&n}async function c(t,n){try{return(await fetch(e+"refresh-token",{method:"GET"})).ok?t(n):window.location.href="/login"}catch(e){window.location.href="/login"}}!async function t(){try{const n=await fetch(e+"bookmark");if(n.ok){const e=await n.json(),t=e.filter((e=>"Movie"===e.category)),a=e.filter((e=>"TV Series"===e.category));return document.querySelector("body").innerHTML='<div class="container">\n      <aside class="sidebar">\n        <div class="logo">\n          <a href="/"><img src="./assets/logo.svg" alt="logo"></a>\n        </div>\n        <nav class="navbar">\n          <a href="/">\n            <svg class="home" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 0H1C.4 0 0 .4 0 1v7c0 .6.4 1 1 1h7c.6 0 1-.4 1-1V1c0-.6-.4-1-1-1Zm0 11H1c-.6 0-1 .4-1 1v7c0 .6.4 1 1 1h7c.6 0 1-.4 1-1v-7c0-.6-.4-1-1-1ZM19 0h-7c-.6 0-1 .4-1 1v7c0 .6.4 1 1 1h7c.6 0 1-.4 1-1V1c0-.6-.4-1-1-1Zm0 11h-7c-.6 0-1 .4-1 1v7c0 .6.4 1 1 1h7c.6 0 1-.4 1-1v-7c0-.6-.4-1-1-1Z" fill="#5A698F"/></svg>\n          </a>\n          <a href="movies">\n            <svg class="movies" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M16.956 0H3.044A3.044 3.044 0 0 0 0 3.044v13.912A3.044 3.044 0 0 0 3.044 20h13.912A3.044 3.044 0 0 0 20 16.956V3.044A3.044 3.044 0 0 0 16.956 0ZM4 9H2V7h2v2Zm-2 2h2v2H2v-2Zm16-2h-2V7h2v2Zm-2 2h2v2h-2v-2Zm2-8.26V4h-2V2h1.26a.74.74 0 0 1 .74.74ZM2.74 2H4v2H2V2.74A.74.74 0 0 1 2.74 2ZM2 17.26V16h2v2H2.74a.74.74 0 0 1-.74-.74Zm16 0a.74.74 0 0 1-.74.74H16v-2h2v1.26Z" fill="#5A698F"/></svg>\n          </a>\n          <a href="/tv">\n            <svg class="tv__series" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M20 4.481H9.08l2.7-3.278L10.22 0 7 3.909 3.78.029 2.22 1.203l2.7 3.278H0V20h20V4.481Zm-8 13.58H2V6.42h10v11.64Zm5-3.88h-2v-1.94h2v1.94Zm0-3.88h-2V8.36h2v1.94Z" fill="#5A698F"/></svg>\n          </a>\n          <a href="/bookmark">\n            <svg class="bookmark__nav active" viewBox="0 0 17 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.387 0c.202 0 .396.04.581.119.291.115.522.295.694.542.172.247.258.52.258.82v17.038c0 .3-.086.573-.258.82a1.49 1.49 0 0 1-.694.542 1.49 1.49 0 0 1-.581.106c-.423 0-.79-.141-1.098-.423L8.46 13.959l-5.83 5.605c-.317.29-.682.436-1.097.436-.202 0-.396-.04-.581-.119a1.49 1.49 0 0 1-.694-.542A1.402 1.402 0 0 1 0 18.52V1.481c0-.3.086-.573.258-.82A1.49 1.49 0 0 1 .952.119C1.137.039 1.33 0 1.533 0h13.854Z" fill="#5A698F"/></svg>\n          </a>\n        </nav>\n        <div class="avatar">\n          <img src="./assets/image-avatar.png" alt="avatar">\n        </div>\n        <div class="logout__container none">\n          <div class="logout"><p>Logout</p></div>\n        </div>\n      </aside>\n      <main>\n        <form class="search">\n          <img class="logo__search" src="./assets/icon-search.svg" alt="logo search">\n          <label class="input__label">\n            <input class="input__search fs-xl" type="text" name="s" id="search" placeholder="Search for movies or TV series" value="">\n          </label>\n        </form>\n        <div class="container__b"></div>\n      </main>\n    </div>',o(t,a)}return c(t)}catch(e){console.log()}}()}));